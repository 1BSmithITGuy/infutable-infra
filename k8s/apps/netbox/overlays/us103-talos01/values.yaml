# Cluster-specific overlay for us103-talos01 (Talos + MetalLB + Cilium CNI)
ingress:
  enabled: true
  className: nginx-public
  annotations:
    nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "3600"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "3600"
  hosts:
    - host: netbox.infra.infutable.com
      paths:
        - /
  tls: []

persistence:
  enabled: true
  storageClass: local-path

resources:
  requests:
    cpu: 200m
    memory: 512Mi
  limits:
    cpu: 1
    memory: 1Gi

# PostgreSQL storage
postgresql:
  auth:
    # Use existing secret for credentials (stored in /srv/secrets/netbox/)
    # Secret must be applied manually: kubectl apply -f /srv/secrets/netbox/postgresql-passwords.yaml
    existingSecret: netbox-postgresql-credentials
    secretKeys:
      adminPasswordKey: postgres-password
      userPasswordKey: password
  primary:
    persistence:
      storageClass: local-path
      size: 8Gi

# Valkey (Redis) storage
valkey:
  master:
    persistence:
      storageClass: local-path
      size: 1Gi
  replica:
    persistence:
      storageClass: local-path
      size: 1Gi
