#  Author:  Bryan Smith
#  date:    11/10/2025
#  Base velero config - all clusters

# Override kubectl image - Helm chart defaults to bitnamilegacy (outdated)
# Using bitnami/kubectl:1.31.3 (has shell, needed for init containers)
# kubectl version skew allows +/- 1 minor version from K8s server
kubectl:
  image:
    repository: bitnami/kubectl
    tag: "1.31.3"

deployNodeAgent: true

nodeAgent:
  podVolumePath: /var/lib/kubelet/pods
  privileged: false
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1024Mi

resources:
  requests:
    cpu: 500m
    memory: 128Mi
  limits:
    cpu: 1000m
    memory: 512Mi

metrics:
  enabled: true
  serviceMonitor:
    enabled: false

credentials:
  useSecret: true
  existingSecret: velero-s3-credentials

initContainers:
- name: velero-plugin-for-aws
  image: velero/velero-plugin-for-aws:v1.9.0
  volumeMounts:
  - mountPath: /target
    name: plugins