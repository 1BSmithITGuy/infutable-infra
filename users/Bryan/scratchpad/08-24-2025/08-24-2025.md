# 08-24-2025

## Inbox
Setup grafana monitoring for other components

## Notes

Left off:  I added to prometheous config.  

need to: figure out values with dashboards yaml, deploy auto dashboards, 
step 3, 


Need to have clude go through files, not all are needed, regenerate readme with external-monitoring (oir whatever directory it should be called - platform?), check directories, check comments in yaml, 
-  put basic yaml config in there?

```yaml
grafana:
  ingress:
    enabled: true
    ingressClassName: nginx
    hosts:
      - grafana.us103kubeadm01.infutable.com
  
  # Auto-provision these dashboards on deployment
  dashboardProviders:
    dashboardproviders.yaml:
      apiVersion: 1
      providers:
      - name: 'default'
        orgId: 1
        folder: 'General'
        type: file
        disableDeletion: false
        updateIntervalSeconds: 10
        options:
          path: /var/lib/grafana/dashboards/default
  
  dashboards:
    default:
      # Multi-cluster overview
      kubernetes-cluster-monitoring:
        gnetId: 315
        revision: 3
        datasource: Prometheus
      # Node-level deep dive  
      node-exporter-full:
        gnetId: 1860
        revision: 33
        datasource: Prometheus
      # Cluster resources
      kubernetes-cluster-prometheus:
        gnetId: 6417
        revision: 1
        datasource: Prometheus

prometheus:
  prometheusSpec:
    retention: 15d
    storageSpec:
      volumeClaimTemplate:
        spec:
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 10Gi
    
    # External labels to identify THIS Prometheus
    externalLabels:
      cluster: kubeadm    #  changed!
      region: us103 #  site - changed
    
    # Monitor K3s cluster
    additionalScrapeConfigs:
    - job_name: 'k3s-nodes'
      static_configs:
      - targets: 
        # Replace with your K3s node IPs
        - '10.0.3.10:30910'  # K3s master
        - '10.0.3.11:30910'  # K3s worker if exists
      relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        regex: '([^:]+):.*'
        replacement: '${1}'
      - target_label: cluster
        replacement: 'k3s'
      - target_label: environment
        replacement: 'homelab'
    ```

    should i put in a label of masterNode?  to identify the hostname of the master node?  